#!/bin/bash -x

set -euo pipefail
PORT=${1} && shift
LINE=$(sudo netstat -tlpn 2>/dev/null | grep "[^0-9]${PORT}[^0-9]")
if test -n "${LINE}"; then
    PID=$(grep -o '[0-9]*/' <<< "${LINE}" | cut -f1 -d/)
    echo -e "${LINE}\n" 1>&2
    xargs -L1 ps -w30 -fp <<< "${PID}"  1>&2
    echo ${PID} | tr ' ' '\n' | sort | uniq
fi

# Local Variables:
# mode: sh-mode
# End:
